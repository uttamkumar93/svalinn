{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://svalinn.dev/schemas/doctor-report.v1.json",
  "title": "Vordr Doctor Report",
  "description": "Output schema for 'vordr doctor --format json'",
  "type": "object",
  "required": ["version", "timestamp", "checks", "summary"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Vordr version that generated this report"
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp or Unix epoch"
    },
    "checks": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/CheckResult"
      }
    },
    "summary": {
      "$ref": "#/definitions/Summary"
    },
    "next_steps": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Suggested fix commands for failures"
    }
  },
  "definitions": {
    "CheckResult": {
      "type": "object",
      "required": ["category", "name", "status", "message"],
      "properties": {
        "category": {
          "type": "string",
          "description": "Check category (Runtime, Networking, etc.)"
        },
        "name": {
          "type": "string",
          "description": "Machine-readable check identifier"
        },
        "status": {
          "type": "string",
          "enum": ["pass", "warn", "fail"]
        },
        "message": {
          "type": "string",
          "description": "Human-readable result message"
        },
        "fix": {
          "$ref": "#/definitions/FixCommand"
        }
      }
    },
    "FixCommand": {
      "type": "object",
      "required": ["command"],
      "properties": {
        "command": {
          "type": "string",
          "description": "Command to run to fix the issue"
        },
        "persist": {
          "type": "string",
          "description": "Command to make fix permanent"
        }
      }
    },
    "Summary": {
      "type": "object",
      "required": ["passed", "warnings", "errors"],
      "properties": {
        "passed": {
          "type": "integer",
          "minimum": 0
        },
        "warnings": {
          "type": "integer",
          "minimum": 0
        },
        "errors": {
          "type": "integer",
          "minimum": 0
        }
      }
    }
  }
}
